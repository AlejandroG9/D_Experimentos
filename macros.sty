\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{macros}[2025/08/18 Macros para manual de Diseño y Análisis de Experimentos]

% Paquetes requeridos
\RequirePackage{environ} % para \NewEnviron y \BODY
\RequirePackage{amsmath, amssymb, amsthm}
\RequirePackage{siunitx}
\RequirePackage{booktabs}
\RequirePackage{enumitem}
\RequirePackage{xcolor}
\RequirePackage{hyperref}
\RequirePackage{float}
\RequirePackage{pdflscape} % o \RequirePackage{lscape}
\hypersetup{colorlinks=true, linkcolor=blue, urlcolor=blue, citecolor=blue}

% -------------------------------
% Toggle para mostrar/ocultar soluciones
% -------------------------------
\newif\ifshowsolutions
\showsolutionsfalse   % por defecto, NO mostrar
%\showsolutionstrue   % descomenta esta línea para mostrar soluciones

% -------------------------------
% Entorno de ejercicio
% -------------------------------
\newcounter{ejercicio}
\newenvironment{ejercicio}[1][]{
  \refstepcounter{ejercicio}
  \par\medskip
  \noindent\textbf{Ejercicio \theejercicio.} \textit{#1}\par
  \noindent\rule{\textwidth}{0.4pt}\par\medskip
}{\par\medskip \noindent\rule{\textwidth}{0.4pt}\par\medskip}

% -------------------------------
% Entorno 'clave' condicionado (versión robusta con environ)
% -------------------------------
% NOTA: No usar \newenvironment aquí. Esta versión evita el "Incomplete \iffalse".
\NewEnviron{clave}{%
  \ifshowsolutions
    \par\medskip
    \noindent\textbf{Clave rápida (solo profesor)}\par
    \begingroup\small
    \BODY
    \par\endgroup\medskip
  \fi
}

% -------------------------------
% Entorno de pasos
% -------------------------------
\newenvironment{pasos}{\begin{enumerate}[leftmargin=*, itemsep=2pt]}{\end{enumerate}}

% -------------------------------
% Comando para datos en bloque monoespaciado
% -------------------------------
\newcommand{\datos}[1]{%
  \par\medskip
  \noindent\textbf{Datos (muestra)}\par
  \begingroup\ttfamily\small #1 \par\endgroup
  \medskip
}

